define(["jquery"],function(a){var b={baseUrl:"",sessKey:"",qid:"",headerCheckboxChecked:!0,init:function(){var c=a("#attemptsform").attr("action");b.baseUrl=c.replace("testquestion.php","api/updater.php"),b.sessKey=a('#attemptsform input[name="sesskey"]').val(),b.qid=a('#attemptsform input[name="id"]').val(),a(document).on("click",".updater-ef",function(){var c=a(this).data("id");return b.update(c),!1}),a(document).on("keypress","#tablecontainer :checkbox",function(b){13==(b.keyCode?b.keyCode:b.which)&&(b.preventDefault(),a(this).trigger("click"))}),a("#tqheadercheckbox").click(function(){b.headerCheckboxChecked?(a(this).attr("title",M.util.get_string("deselectall","moodle")),b.headerCheckboxChecked=!1):(a(this).attr("title",M.util.get_string("selectall","moodle")),b.headerCheckboxChecked=!0),a("#tablecontainer :checkbox").each(function(){this.checked=!b.headerCheckboxChecked}),a(this).prop("checked",!1)})},update:function(c){var d=a("#updater-ef_"+c).text(),e=0;e="1"===d?0:1;var f={qid:b.qid,rid:c,expectedfraction:e,sesskey:b.sessKey};a.post(b.baseUrl,f,function(b){if("success"===b.status){a("#updater-ef_"+c).text(b.ef),a("#updater-ef_"+c).parent().prev().text(b.gf);var d=a("#updater-ef_"+c).parent().parent();d.removeClass(),d.addClass(b.rowclass),d.find('td[class="c3"]').text(b.gf);var e=M.util.get_string("testquestionresultssummary","qtype_pmatch",b.counts);a("#testquestion_gradesummary").html(e)}else window.console.log("Testquestion response updater has experienced an issue.\n"+b.data)})}};return b});