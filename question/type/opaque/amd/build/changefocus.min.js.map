{"version":3,"sources":["../src/changefocus.js"],"names":["define","$","t","init","document","ready","checkButton","opaqueTryAgainButton","lastindex","localStorage","getItem","removeItem","setTimeout","animate","scrollTop","offset","top","focusTryAgainButton","length","focus","blur","on","e","keyCode","which","preventDefault","shiftKey","slot","getQuestionIndex","attr","click","setItem","str","target","id","questionindex","substr","indexOf"],"mappings":"AAuBAA,OAAM,4BAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAI3B,GAAIC,CAAAA,CAAC,CAAG,CACJC,IAAI,CAAG,eAAW,CACdF,CAAC,CAAEG,QAAF,CAAD,CAAcC,KAAd,CAAoB,UAAW,IACvBC,CAAAA,CAAW,CAAGL,CAAC,CAAC,4BAAD,CADQ,CAEvBM,CAAoB,CAAGN,CAAC,CAAC,yBAAD,CAFD,CAIvBO,CAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,qBAArB,CAJW,CAK3BD,YAAY,CAACE,UAAb,CAAwB,qBAAxB,EAEA,GAAkB,IAAd,GAAAH,CAAJ,CAAwB,CAEpBI,UAAU,CAAC,UAAY,CAEnBX,CAAC,CAAC,YAAD,CAAD,CAAgBY,OAAhB,CAAwB,CACpBC,SAAS,CAAEb,CAAC,CAAC,KAAOO,CAAR,CAAD,CAAoBO,MAApB,GAA6BC,GADpB,CAAxB,CAEG,GAFH,EAKA,GAAIC,CAAAA,CAAmB,CAAGhB,CAAC,CAAC,gBAAsBO,CAAtB,eAAD,CAA3B,CACA,GAAoC,CAAhC,CAAAP,CAAC,CAACgB,CAAD,CAAD,CAAuBC,MAA3B,CAAuC,CACnCjB,CAAC,CAACgB,CAAD,CAAD,CAAuBE,KAAvB,EACH,CAFD,IAEO,CACHlB,CAAC,CAAC,0BAAD,CAAD,CAA4BmB,IAA5B,EACH,CACJ,CAbS,CAaP,GAbO,CAcb,CAEDb,CAAoB,CAACc,EAArB,CAAwB,SAAxB,CAAmC,SAAUC,CAAV,CAAa,CAC5C,GAAIC,CAAAA,CAAO,CAAGD,CAAC,CAACC,OAAF,EAAaD,CAAC,CAACE,KAA7B,CACAF,CAAC,CAACG,cAAF,GAEA,GAAe,CAAX,EAAAF,CAAO,EAAS,CAACD,CAAC,CAACI,QAAvB,CAAiC,CAC7B,GAAIC,CAAAA,CAAI,CAAGzB,CAAC,CAAC0B,gBAAF,CAAmBN,CAAnB,CAAX,CACArB,CAAC,CAAC,KAAO0B,CAAP,CAAc,0BAAf,CAAD,CAA4CR,KAA5C,GACAlB,CAAC,CAAC,IAAD,CAAD,CAAQ4B,IAAR,CAAa,UAAb,CAAyB,CAAC,CAA1B,CACH,CACJ,CATD,EAYA5B,CAAC,CAACK,CAAD,CAAD,CAAewB,KAAf,CAAqB,SAAUR,CAAV,CAAa,CAC9Bb,YAAY,CAACsB,OAAb,CAAqB,qBAArB,CAA4C7B,CAAC,CAAC0B,gBAAF,CAAmBN,CAAnB,CAA5C,CACH,CAFD,EAKArB,CAAC,CAACM,CAAD,CAAD,CAAwBuB,KAAxB,CAA8B,SAAUR,CAAV,CAAa,CACvCb,YAAY,CAACsB,OAAb,CAAqB,qBAArB,CAA4C7B,CAAC,CAAC0B,gBAAF,CAAmBN,CAAnB,CAA5C,CACH,CAFD,CAGH,CA7CD,CA8CH,CAhDG,CAiDJM,gBAAgB,CAAE,0BAAUN,CAAV,CAAa,IAEvBU,CAAAA,CAAG,CAAGV,CAAC,CAACW,MAAF,CAASC,EAFQ,CAGvBC,CAAa,CAAGH,CAAG,CAACI,MAAJ,CAAWJ,CAAG,CAACK,OAAJ,CAAY,GAAZ,EAAmB,CAA9B,CAHO,CAI3BF,CAAa,CAAGA,CAAa,CAACC,MAAd,CAAqB,CAArB,CAAwBD,CAAa,CAACE,OAAd,CAAsB,GAAtB,CAAxB,CAAhB,CACA,MAAOF,CAAAA,CACV,CAvDG,CAAR,CAyDA,MAAOjC,CAAAA,CACV,CA9DK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript change opaque question focus.\n *\n * @package   mod_quiz\n * @copyright 2017 The Open University\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since     3.2\n */\ndefine(['jquery'], function($) {\n    /**\n     * @alias module:mod_quiz/attempt\n     */\n    var t = {\n        init : function() {\n            $( document ).ready(function() {\n                var checkButton = $('input[id*=\"_omact_gen_\"]');\n                var opaqueTryAgainButton = $('input[id*=\"omact_ok\"]');\n\n                var lastindex = localStorage.getItem('last_question_index');\n                localStorage.removeItem('last_question_index');\n                /* Check if last question is set */\n                if (lastindex !== null) {\n                    // Because we got timeout inside inline script so we need to wait for that timeout.\n                    setTimeout(function () {\n                        // Scroll to last checked question.\n                        $('html, body').animate({\n                            scrollTop: $('#q' + lastindex).offset().top\n                        }, 100);\n\n                        // Focus on \"Try again\" button if exist otherwise blur all other button.\n                        var focusTryAgainButton = $('input[id*=' + '\":' + lastindex + '_omact_ok\"' + ']');\n                        if ($(focusTryAgainButton).length > 0) {\n                            $(focusTryAgainButton).focus();\n                        } else {\n                            $('input[id*=\"_omact_ok\"]').blur();\n                        }\n                    }, 350);\n                }\n\n                opaqueTryAgainButton.on('keydown', function (e) {\n                    var keyCode = e.keyCode || e.which;\n                    e.preventDefault();\n                    // Tab on Try again button.\n                    if (keyCode == 9 && !e.shiftKey) {\n                        var slot = t.getQuestionIndex(e);\n                        $('#q' + slot + ' input.questionflagimage').focus();\n                        $(this).attr('tabindex', -1);\n                    }\n                });\n\n                // Check button clicked.\n                $(checkButton).click(function (e) {\n                    localStorage.setItem('last_question_index', t.getQuestionIndex(e));\n                });\n\n                // Try again button clicked.\n                $(opaqueTryAgainButton).click(function (e) {\n                    localStorage.setItem('last_question_index', t.getQuestionIndex(e));\n                });\n            });\n        },\n        getQuestionIndex: function (e) {\n            // Save last position to scroll back to that question when the page is re-rendered.\n            var str = e.target.id;\n            var questionindex = str.substr(str.indexOf(':') + 1);\n            questionindex = questionindex.substr(0, questionindex.indexOf('_'));\n            return questionindex;\n        }\n    };\n    return t;\n});\n"],"file":"changefocus.min.js"}