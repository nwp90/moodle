{"version":3,"sources":["../src/rubric.js"],"names":["define","$","Templates","ModalFactory","ModalEvents","ModalRubricManagerLaunch","ModalRubricViewLaunch","rubric","that","on","rubricCreateModal","TYPE","document","mousedown","val","confirm","M","str","plagiarism_turnitin","changerubricwarning","modalType","cmid","urlParams","URLSearchParams","window","location","search","get","create","type","templateContext","wwwroot","cfg","large","then","modal","show","getRoot","find","addClass"],"mappings":"AASAA,OAAM,8BAAC,CAAC,QAAD,CACC,gBADD,CAEC,oBAFD,CAGC,mBAHD,CAIC,iDAJD,CAKC,8CALD,CAAD,CAOF,SAASC,CAAT,CAAYC,CAAZ,CAAuBC,CAAvB,CAAqCC,CAArC,CAAkDC,CAAlD,CAA4EC,CAA5E,CAAmG,CAC/F,MAAO,CACHC,MAAM,CAAE,iBAAW,CACf,GAAIC,CAAAA,CAAI,CAAG,IAAX,CACAP,CAAC,CAAC,wBAAD,CAAD,CAA4BQ,EAA5B,CAA+B,OAA/B,CAAwC,UAAW,CAC/CD,CAAI,CAACE,iBAAL,CAAuBL,CAAwB,CAACM,IAAhD,CACH,CAFD,EAIAV,CAAC,CAACW,QAAD,CAAD,CAAYH,EAAZ,CAAe,OAAf,CAAwB,cAAxB,CAAwC,UAAW,CAC/CD,CAAI,CAACE,iBAAL,CAAuBJ,CAAqB,CAACK,IAA7C,CACH,CAFD,EAKAV,CAAC,CAAC,uBAAD,CAAD,CAA2BY,SAA3B,CAAqC,UAAY,CAC7C,GAAyC,EAArC,EAAAZ,CAAC,CAAC,0BAAD,CAAD,CAA4Ba,GAA5B,IAA2F,GAAhD,EAAAb,CAAC,CAAC,qCAAD,CAAD,CAAuCa,GAAvC,EAA/C,CAAoG,CAChG,GAAIC,OAAO,CAACC,CAAC,CAACC,GAAF,CAAMC,mBAAN,CAA0BC,mBAA3B,CAAX,CAA4D,CACxDlB,CAAC,CAAC,qCAAD,CAAD,CAAuCa,GAAvC,CAA2C,GAA3C,CACH,CACJ,CACJ,CAND,CAOH,CAnBE,CAoBHJ,iBAAiB,CAAE,2BAASU,CAAT,CAAoB,CACnC,GAAInB,CAAC,CAAC,8BAAD,CAAD,CAAgCa,GAAhC,EAAJ,CAA2C,CACvC,GAAIO,CAAAA,CAAI,CAAGpB,CAAC,CAAC,8BAAD,CAAD,CAAgCa,GAAhC,EACd,CAFD,IAEO,IACCQ,CAAAA,CAAS,CAAG,GAAIC,CAAAA,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CADb,CAECL,CAAI,CAAGC,CAAS,CAACK,GAAV,CAAc,IAAd,CACd,CAEDxB,CAAY,CAACyB,MAAb,CAAoB,CAChBC,IAAI,CAAET,CADU,CAEhBU,eAAe,CAAE,CACbT,IAAI,CAAEA,CADO,CAEbU,OAAO,CAAEf,CAAC,CAACgB,GAAF,CAAMD,OAFF,CAFD,CAMhBE,KAAK,GANW,CAApB,EAQKC,IARL,CAQU,SAAUC,CAAV,CAAiB,CACnBA,CAAK,CAACC,IAAN,GACAD,CAAK,CAACE,OAAN,GAAgBC,IAAhB,CAAqB,QAArB,EAA+BC,QAA/B,CAAwC,qBAAxC,EACAJ,CAAK,CAACE,OAAN,GAAgBC,IAAhB,CAAqB,gBAArB,EAAuCC,QAAvC,CAAgD,6BAAhD,CACH,CAZL,CAaH,CAzCE,CA2CV,CAnDC,CAAN","sourcesContent":["/**\n * Javascript controller for handling rubrics.\n *\n * @package   turnitin\n * @copyright Turnitin\n * @author 2019 David Winn <dwinn@turnitin.com>\n * @module plagiarism_turnitin/rubric\n */\n\ndefine(['jquery',\n        'core/templates',\n        'core/modal_factory',\n        'core/modal_events',\n        'plagiarism_turnitin/modal_rubric_manager_launch',\n        'plagiarism_turnitin/modal_rubric_view_launch'\n    ],\n    function($, Templates, ModalFactory, ModalEvents, ModalRubricManagerLaunch, ModalRubricViewLaunch) {\n        return {\n            rubric: function() {\n                var that = this;\n                $('.rubric_manager_launch').on('click', function() {\n                    that.rubricCreateModal(ModalRubricManagerLaunch.TYPE);\n                });\n\n                $(document).on('click', '.rubric_view', function() {\n                    that.rubricCreateModal(ModalRubricViewLaunch.TYPE);\n                });\n\n                // Show warning when changing the rubric linked to an assignment.\n                $('#id_plagiarism_rubric').mousedown(function () {\n                    if ($('input[name=\"instance\"]').val() != '' && $('input[name=\"rubric_warning_seen\"]').val() != 'Y') {\n                        if (confirm(M.str.plagiarism_turnitin.changerubricwarning)) {\n                            $('input[name=\"rubric_warning_seen\"]').val('Y');\n                        }\n                    }\n                });\n            },\n            rubricCreateModal: function(modalType) {\n                if ($('input[name=\"coursemodule\"]').val()) {\n                    var cmid = $('input[name=\"coursemodule\"]').val();\n                } else {\n                    var urlParams = new URLSearchParams(window.location.search);\n                    var cmid = urlParams.get('id');\n                }\n\n                ModalFactory.create({\n                    type: modalType,\n                    templateContext: {\n                        cmid: cmid,\n                        wwwroot: M.cfg.wwwroot\n                    },\n                    large: true\n                })\n                    .then(function (modal) {\n                        modal.show();\n                        modal.getRoot().find('.modal').addClass('tii_pp_modal_rubric');\n                        modal.getRoot().find('.modal-content').addClass('tii_pp_modal_rubric_content');\n                    });\n            }\n        };\n    });"],"file":"rubric.min.js"}