define ("block_cmapcore/element-list",["jquery","core/ajax"],function(a){function b(){var b,c,d=a("fieldset .ftags select#id_tags_officialtags > option");if(0!==d.length){a(".presentation-list li").prepend("<input type=\"checkbox\">")}a(".presentation-list li input").change(function(){b=a(this).parent().text();c=a(this);d.each(function(d,e){b=b.replace(",","");if(-1<b.indexOf(e.value)){if(c.prop("checked")){a(e).attr("selected","selected")}else{a(e).removeAttr("selected")}}})})}function c(c,d){var e=[],f={p:{abbrev:"pres",linkname:"presentationlinks",nameprop:"presentation_name",idprop:"presentation_id",mapui:"/ui/presentations"},c:{abbrev:"cond",linkname:"conditionlinks",nameprop:"condition_name",idprop:"condition_id",mapui:"/ui/conditions"},a:{abbrev:"acty",linkname:"activitylinks",nameprop:"activity_name",idprop:"activity_id",mapui:"/ui/activities"}};if(d){var g=d+"/"+f[c].linkname+"/?format=json&linkage=strong&page_size=999",h="#cmap-"+f[c].abbrev+"-div",i=a(h),j=i.find(".noelements"),k=i.find(".elementlist"),l=i.find(".loading");l.show();a.getJSON(g,function(d){var g=[];if(0===d.count){l.hide();j.show();k.hide()}else{l.hide();a.each(d.results,function(a,b){itemtext="<li id='"+a+"'><a target='_blank' href='"+"https://medmap.otago.ac.nz"+f[c].mapui+"/"+b[f[c].idprop]+"'>"+b[f[c].nameprop]+"</a></li>";e.push(b[f[c].nameprop]);g.push(itemtext)});a("<ul/>",{html:g.join("")}).appendTo(k);k.show();b(e)}}).fail(function(){l.hide();j.show()})}else{l.hide();j.show()}}function d(b){return function(d){var e=d.modulesversion.url,f=a(".block.block_cmapcore:not(.block_with_controls)");a.ajax({url:e+"modules/"+b+"/",success:function success(a){f.show();c("p",a.url);c("c",a.url);c("a",a.url)},statusCode:{404:function _(){console.log("module '"+b+"' not found in cmap default site version");f.hide()}}})}}return{init:function init(b,c,e){if(!this.initialized){a(".pres-loading").show();if("undefined"!=typeof b){this.mapbase=b}var f=this.mapbase+"/cmapapi/siteversions/default/";a.ajax({url:f,success:d(e),statusCode:{404:function _(){console.log("default site version not found in cmap");cmapcore.hide()},500:function _(){console.log("error fetching default site version from cmap");cmapcore.hide()}}})}}}});
//# sourceMappingURL=element-list.min.js.map
