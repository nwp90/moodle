YUI.add("moodle-atto_embedquestion-button",function(e,t){e.namespace("M.atto_embedquestion").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){var e;if(!this.get("enablebutton"))return;this.addButton({icon:"icon",iconComponent:"atto_embedquestion",callback:this.displayDialogue}),this.get("host").on("atto:selectionchanged",function(){this.getEmbedCodeAtSelection()?this.highlightButtons():this.unHighlightButtons()},this),e=this.getDialogue({headerContent:M.util.get_string("pluginname","atto_embedquestion"),width:"600px",focusAfterHide:!0},!0),e.on("visibleChange",function(t){t.newVal||e.set("bodyContent","")})},displayDialogue:function(){var e=this;require(["atto_embedquestion/dialogue_manager"],function(t){t.showDialogueFor(e)})},getEmbedCodeAtSelection:function(){var t=this.get("host").getSelectionParentNode(),n=this.get("host").getSelection(),r,i=!1,s=/\{Q\{(?:(?!\}Q\}).)*\}Q\}/g,o;return t?!n||n.length===0?!1:(n=n[0],r=t.textContent,o=r.match(s),!o||!o.length?!1:(e.Array.find(o,function(e){var t=0;while(r.indexOf(e,t)!==-1){var s=r.indexOf(e,t),o=s+e.length,u=n.startOffset>=s&&n.startOffset<o,a=n.endOffset<=o&&n.endOffset>s;if(u&&a)return i={start:s,end:o,embedCode:e},!0;t=o}return!1},this),i)):!1}},{ATTRS:{enablebutton:{value:!1},contextid:{value:!1},elementid:{value:!1}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
