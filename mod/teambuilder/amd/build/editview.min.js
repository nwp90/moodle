define ("mod_teambuilder/editview",["jquery","jqueryui","core/config","core/str","core/notification"],function(a,b,c,d,e){var f={error:"",enteratleasttwoanswers:"",enteraquestion:"",enteratleastonequestion:"",saving:"",types:{one:"",any:"",atleastone:""}},g=function(a){f.error=a[0];f.enteratleasttwoanswers=a[1];f.enteraquestion=a[2];f.enteratleastonequestion=a[3];f.saving=a[4];f.types.one=a[5];f.types.any=a[6];f.types.atleastone=a[7]},h={question:"<div class=\"question\"><table>     \t<tr>     \t\t<td rowspan=\"2\" class=\"handle\">&nbsp;</td>     \t\t<td><span class=\"questionText\"></span> <span class=\"type\"></span></td>     \t\t<td colspan=\"2\" class=\"edit\">     \t\t\t<a class=\"deleteQuestion\">Delete</a>     \t\t</td>     \t</tr>     \t<tr>     \t\t<td class=\"answers\" colspan=\"2\"></td>     \t</tr></table></div>"},i=function(){a("<input type=\"text\" name=\"answers[]\" class=\"text\" /><br/>").insertBefore("#answerSection button:first").focus();return!1},j=function(){a("#answerSection input:last").next().remove();a("#answerSection input:last").remove()},k=function(b){a(b).closest("div.question").slideUp(300,function(){a(this).remove()})},l=function(b){var d=a(b.target).attr("data-id"),g=a("#questions div.question"),h=[];if(1>g.length){e.alert(f.error,f.enteratleastonequestion);return}g.each(function(){var b=a(this).data("question");b.answers=[];a(this).find(".answers ul li").each(function(){b.answers.push(a(this).html())});h.push(b)});a("#savingIndicator").html(f.saving).slideDown(300);a.post(c.wwwroot+"/mod/teambuilder/ajax.php",{id:d,action:"saveQuestionnaire",input:JSON.stringify(h)},function(b){for(var c in b.questionnaire){var d=b.questionnaire[c];g.eq(parseInt(d.ordinal)).data("question",d)}a("#savingIndicator").html("Saved!").wait(2e3).slideUp(300)},"json")},m=function(){var b={question:a("#newQuestionForm input[name='question']").val(),type:a("#newQuestionForm select").val(),answers:[]};a("#answerSection input[type='text']").each(function(){if(a.trim(a(this).val()).length){b.answers.push(a(this).val())}});var c=[];if(""==a.trim(b.question)){c.push(f.enteraquestion)}if(1>=b.answers.length){c.push(f.enteratleasttwoanswers)}if(c.length){e.alert(f.error,c.join("<br />"));return}var d=a(h.question);d.find(".questionText").html(b.question);d.find(".type").html(f.types[b.type]);d.find(".answers").html("<ul><li>"+b.answers.join("</li><li>")+"</li></ul>");a("#questions").append(d);d.find(".answers ul").sortable({axis:"y"}).find("li").css("cursor","default");d.data("question",b);a("#newQuestionForm input").val("");a("#saveQuestionnaire").click();return!1},n=function(){for(var b in init_questions){a("#question-"+b).data("question",init_questions[b])}a("#answerSection input").on("keydown",function(b){if(13==b.which&&!(b.metaKey||b.ctrlKey)){if(0==a(this).nextAll("input:first").length){i()}else{a(this).nextAll("input:first").focus()}}else if(38==b.which){a(this).prevAll("input:first").focus()}else if(40==b.which){a(this).nextAll("input:first").focus()}});a("#newQuestionForm input").on("keydown",function(b){if(13==b.which&&(b.metaKey||b.ctrlKey)){m();a("#newQuestionForm input[name='question']").focus()}});a.fn.wait=function(b,c){b=b||1e3;c=c||"fx";return this.queue(c,function(){var c=this;setTimeout(function(){a(c).dequeue()},b)})};a("#importButton").click(function(){window.location.href=window.location.href+"&import="+a(this).prevAll("select:first").val()})},o=function(){a("#addNewQuestion").on("click",m);a("#saveQuestionnaire").on("click",l);a("#addnewanswer").on("click",i);a("#removelastanswer").on("click",j);a("#questions").delegate(".deleteQuestion","click",function(a){a.preventDefault();k(a.target)})};return{init:function init(){d.get_strings([{key:"error",component:"error"},{key:"enteratleasttwoanswers",component:"mod_teambuilder"},{key:"enteraquestion",component:"mod_teambuilder"},{key:"enteratleastonequestion",component:"mod_teambuilder"},{key:"saving",component:"mod_teambuilder"},{key:"selectone",component:"mod_teambuilder"},{key:"selectany",component:"mod_teambuilder"},{key:"selectatleastone",component:"mod_teambuilder"}]).done(function(a){g(a);n()});o()}}});
//# sourceMappingURL=editview.min.js.map
